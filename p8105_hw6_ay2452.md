p8105\_hw6\_ay2452
================
Alicia Yang
11/25/2019

``` r
birthweight = 
  read_csv("./data/birthweight.csv") %>%
  mutate(
    babysex = as.factor(babysex), 
    frace = as.factor(frace), 
    malform = as.factor(malform), 
    mrace = as.factor(mrace)
  )
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_double()
    ## )

    ## See spec(...) for full column specifications.

``` r
map(birthweight, ~sum(is.na(.)))
```

    ## $babysex
    ## [1] 0
    ## 
    ## $bhead
    ## [1] 0
    ## 
    ## $blength
    ## [1] 0
    ## 
    ## $bwt
    ## [1] 0
    ## 
    ## $delwt
    ## [1] 0
    ## 
    ## $fincome
    ## [1] 0
    ## 
    ## $frace
    ## [1] 0
    ## 
    ## $gaweeks
    ## [1] 0
    ## 
    ## $malform
    ## [1] 0
    ## 
    ## $menarche
    ## [1] 0
    ## 
    ## $mheight
    ## [1] 0
    ## 
    ## $momage
    ## [1] 0
    ## 
    ## $mrace
    ## [1] 0
    ## 
    ## $parity
    ## [1] 0
    ## 
    ## $pnumlbw
    ## [1] 0
    ## 
    ## $pnumsga
    ## [1] 0
    ## 
    ## $ppbmi
    ## [1] 0
    ## 
    ## $ppwt
    ## [1] 0
    ## 
    ## $smoken
    ## [1] 0
    ## 
    ## $wtgain
    ## [1] 0

``` r
proposed = 
  lm(bwt ~ momage + gaweeks + blength, data = birthweight)


proposed %>%
  broom::tidy() %>%
  select(term, estimate, p.value) %>%
  knitr::kable(digits = 5)
```

| term        |     estimate | p.value |
| :---------- | -----------: | ------: |
| (Intercept) | \-4450.48228 |       0 |
| momage      |      8.31080 |       0 |
| gaweeks     |     26.04833 |       0 |
| blength     |    128.02256 |       0 |

``` r
birthweight %>% 
  modelr::add_residuals(proposed) %>%
  modelr::add_predictions(proposed) %>%
  gather_predictions(proposed) %>% 
  mutate(model = fct_inorder(model)) %>% 
  ggplot(aes(x = pred, y = resid)) + 
  geom_point(alpha = .5) +
  geom_smooth(aes(y = resid), color = "red") + 
  facet_grid(~model)
```

    ## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'

![](p8105_hw6_ay2452_files/figure-gfm/Problem%201.2-1.png)<!-- --> \#\#
Gestational age and mother’s age at delivery were chosen after reading
scientific papers looking at risk factors for low birth weight babies.
Baby’s length at birth was also included since there should be a
relationship between baby size and baby weight. Variables were all found
to be significantly associated with birthweight. This model does not
appear to be appropriate; linearity is violated.
