---
title: "p8105_hw6_ay2452"
author: "Alicia Yang"
date: "11/25/2019"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(viridis)
library(modelr)
```


```{r Problem 1.1}
birthweight = 
  read_csv("./data/birthweight.csv") %>%
  mutate(
    babysex = as.factor(babysex), 
    frace = as.factor(frace), 
    malform = as.factor(malform), 
    mrace = as.factor(mrace)
  )
  
map(birthweight, ~sum(is.na(.)))
```


```{r Problem 1.2}
proposed = 
  lm(bwt ~ momage + gaweeks + blength, data = birthweight)


proposed %>%
  broom::tidy() %>%
  select(term, estimate, p.value) %>%
  knitr::kable(digits = 5)

birthweight %>% 
  modelr::add_residuals(proposed) %>%
  modelr::add_predictions(proposed) %>%
  gather_predictions(proposed) %>% 
  mutate(model = fct_inorder(model)) %>% 
  ggplot(aes(x = pred, y = resid)) + 
  geom_point(alpha = .5) +
  geom_smooth(aes(y = resid), color = "red") + 
  facet_grid(~model)
```
## Gestational age and mother's age at delivery were chosen after reading scientific papers looking at risk factors for low birth weight babies. Baby's length at birth was also included since there should be a relationship between baby size and baby weight. Variables were all found to be significantly associated with birthweight. This model does not appear to be appropriate; linearity is violated.